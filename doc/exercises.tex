\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or eps§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}

\usepackage{minted}
\usepackage{hyperref}

\usepackage{color}

\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\pe}[1]{\blue{PE: #1}}

\newenvironment{polynomial}
  {\par\vspace{\abovedisplayskip}%
   \setlength{\leftskip}{\parindent}%
   \setlength{\rightskip}{\leftskip}%
   \medmuskip=4mu plus 2mu minus 2mu
   \binoppenalty=0
   \noindent$\displaystyle}
  {$\par\vspace{\belowdisplayskip}}



\newcommand{\ans}[1]{\blue{
\begin{polynomial}
#1
\end{polynomial}
}}


\newcommand{\vect}[1]{\vec{\lowercase{#1}}}

\title{Homework \#1}
\author{
Haylee Crane \\
Paul English \\
Sean Melessa \\
Sarath Thekkedath
}
%\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle
%\section{}
%\subsection{}

\begin{enumerate}
\item[Exercise 1.] Find a formula that describes the trajectory of the point $\mathbf{O}$ in cartesian coordinates as a function of time.

\blue{
\begin{polynomial}
\left(
   \begin{matrix} % or pmatrix or bmatrix or Bmatrix or ...
      cos(\frac{2\pi t}{s}) & -sin(\frac{2 \pi t}{s}) & 0 \\
      sin(\frac{2 \pi t}{s}) & cos(\frac{2 \pi t}{s}) & 0 \\
      0 & 0 & 1 \\
   \end{matrix}\right)
\left(
\begin{matrix}
x_0 \\
y_0 \\
z_0
\end{matrix}
\right)
=
\left(
\begin{matrix}
x_t \\
y_t \\
z_t
\end{matrix}
\right)
\end{polynomial}
}

\blue{
where $s$ is the period of a sidereal day, $\mathbf{u}$ is the latitude of our coordinate, and $\mathbf{v}$ is the longitude of our coordinate.
}

\item[Exercise 2.] Write a program that converts angles from degrees, minutes, and seconds to radians and vice versa. Make sure your program does what it's supposed to do.

\begin{minted}[mathescape,
               linenos,
               numbersep=5pt,
               gobble=2,
               frame=lines,
               framesep=2mm]{clojure}
  
    (s/defn dms->radians :- RadCoordinateList
      [A :- DMSCoordinateList]
      (with-precision 20
        (let [->rad (/ @pi 180)
              deg->rad (* 1 ->rad)
              m->rad (* 1/60 ->rad)
              s->rad (* 1/3600 ->rad)
              times (mmul A (transpose [[1 0 0 0 0 0 0 0 0 0]]))
              orientations (mmul A (transpose [[0 0 0 0 1 0 0 0 0 0]
                                               [0 0 0 0 0 0 0 0 1 0]]))
              heights (mmul A (transpose [[0 0 0 0 0 0 0 0 0 1]]))
              radians (->> [[0 deg->rad m->rad s->rad 0 0 0 0 0 0]
                            [0 0 0 0 0 deg->rad m->rad s->rad 0 0]]
                           transpose
                           (mmul A)
                           (* orientations))
              ]
          (parse-rad-list
           (join-1 times radians heights)))))

    (s/defn radians->dms :- DMSCoordinateList
      [A :- RadCoordinateList]
      (let [times (mmul A (transpose [[1 0 0 0]]))
            heights (mmul A (transpose [[0 0 0 1]]))
            degrees-decimal (->> [[0 (/ 180 @pi) 0 0]
                                  [0 0 (/ 180 @pi) 0]]
                                 (with-precision 20)
                                 transpose
                                 (mmul A))
            orientations (emap #(if (pos? \%) 1 -1) degrees-decimal)
            positive-degrees (emap abs degrees-decimal)
            degrees (emap #(Math/floor \%) positive-degrees)
            minutes-decimal (* 60 (- positive-degrees degrees))
            minutes (emap #(Math/floor \%) minutes-decimal)
            seconds (* 60 (- minutes-decimal minutes))]
        (parse-dms-list
         (join-1 times
                 (join-1-interleave degrees minutes seconds orientations)
                 heights))))
\end{minted}

\blue{
\textbf{Explanation:} On line 1 and 2 we define a function that converts a degrees, minutes, seconds representation to radians. It outputs a list of the form $t \psi \lambda h$ defined as a $RadCoordinateList$, and accepts one value $A$ a matrix consisting of coordinates in the form given at (8). In line 3 we ensure our function uses $BigDecimal$ precision of 20 places. Lines 4-7 calculate the scalar values that are needed to convert to radians. Then in lines 8-11 we separate $t$, $NS/EW$ orientations, and $h$ using matrix operations. Finally starting on line 12 we use a matrix operation with the radian constants and our orientations to perform the actual $dms\to radians$ computation (The $->>$ operator means thread an argument through the last parameter, it just shortens the code). Lastly on lines 18 and 19 we join $t$ and $h$ onto our calculated radians on dimension 1, and ensure that all numbers are parsed to match our output schema.}

\blue{Full source here: \url{https://github.com/log0ymxm/gps-sim/blob/master/src/gps_sim/utils/angles.clj}}

\blue{Test cases available here: \url{https://github.com/log0ymxm/gps-sim/blob/master/test/gps_sim/utils/angles_test.clj}}

\item[Exercise 3.] Find a formula that converts position as given in (8) at time $t = 0$ into cartesian coordinates.

\blue{
With the data schema presented by (8) we have access to latitude $\psi$ and longitude $\lambda$. Assuming we've already converted these to radians, we can calculate the cartesian coordinates by transforming from spherical coordinates as follows. Note traditionally with spherical coordinates we measure $\phi$ as the angle coming off the $z$-axis, with latitude $\psi$ we measure the angle coming from the equator or $xy$-plane, thus $\psi = \pi/2 - \phi$, and we use $cos$ in calculating $x,y$ and $sin$ to calculate $z$.
\begin{polynomial}
\begin{aligned}
x &= \rho \, cos(\psi) cos(\lambda) \\ 
y &= \rho \, cos(\psi) sin(\lambda) \\
z &= \rho \, sin(\psi)
\end{aligned}
\end{polynomial}
}

\blue{where $\rho = (R + h)$.}

\item[Exercise 4.] Find a formula that converts position and general time $t$ as given in (8) into cartesian coordinates.

\blue{
\begin{polynomial}
\begin{aligned}
x &= \rho \, cos(\psi) cos(\frac{2 \pi t}{s} + \lambda) \\ 
y &= \rho \, cos(\psi) sin(\frac{2 \pi t}{s} + \lambda) \\
z &= \rho \, sin(\psi)
\end{aligned}
\end{polynomial}
}

\item[Exercise 5.] Find a formula that converts a position given in cartesian coordinates at time $t = 0$ into a position of the form (8).

\blue{
\begin{polynomial}
\begin{aligned}
\rho &= \sqrt{x^2 + y^2 + z^2} \\ 
\psi &= asin(z / \rho)\\
\lambda &= atan (y / x) \\
\end{aligned}
\end{polynomial}
}

% TODO clarify formula

\item[Exercise 6.] Find a formula that converts general time $t$ and a position given in cartesian coordinates into a position of the form (8).

\blue{
\begin{polynomial}
\begin{aligned}
\rho &= \sqrt{x^2 + y^2 + z^2} \\ 
\psi &= asin(z / \rho)\\
\lambda &= atan (y / x) - \frac{2 \pi t}{s} \\
\end{aligned}
\end{polynomial}
}

\item[Exercise 7.] Find a formula that describes the trajectory of lamp post B12 in cartesian coordinates as a function of time.

\blue{
\begin{polynomial}
\begin{aligned}
\psi &= (1)\frac{\pi}{180} \left( 40 + 45/60 + 55.0/3600  \right) = 0.7114883177\\
\lambda &= (-1)\frac{\pi}{180} \left( 111 + 50/60 + 58.0/3600  \right) = -1.952141072\\
\rho &= (R + 1372.0) \\
x &= \rho \, cos(\psi) cos(\frac{2 \pi t}{s} + \lambda) \\ 
y &= \rho \, cos(\psi) sin(\frac{2 \pi t}{s} + \lambda) \\
z &= \rho \, sin(\psi)
\end{aligned}
\end{polynomial}
}

\item[Exercise 8.] Given a point $\vect{x}$ on earth and a point $\vect{s}$ in space, both in cartesian coordinates, find a condition that tells you whether $\vect{s}$ as viewed from $\vect{x}$ is above the horizon.

Since the horizon line is going to be the orthogonal vector of a vehicle $\vect{v}$, we can project a satellite $\vect{s}$ onto our vehicle and determine where it's oriented around our vehicle.

\blue{
\begin{polynomial}
\begin{aligned}
\frac{\vect{v} \cdot \vect{s}}{||\vect{v}||} &\ge ||\vect{v}|| \\
\vect{v} \cdot \vect{s} &\ge ||\vect{v}||^2
\end{aligned}
\end{polynomial}
}

\item[Exercise 9.] Discuss how to compute $t_S$ and $\vect{x}_S$.

% TODO clarify
\blue{
\begin{polynomial}
\begin{aligned}
\vect{x}_s(t) &= (R + h) [ \vect{u} cos(\frac{2 \pi t}{p} + \theta) + \vect{v} sin(\frac{2 \pi t}{p} + \theta)] \\
F(t_s) &= t_V - \frac{|| \vect{x}_s(t_s) - \vect{x}_v ||}{c} - t_s = 0 \\
t_s &= t_V - \frac{|| \vect{x}_s(t_s) - \vect{x}_v||}{c}
\end{aligned}
\end{polynomial}
}

% TODO discuss using newton's method to solve, or fixed point projection

\item[Exercise 10.] Suppose you have data of the form from (11) from 4 satellites. Write down a set of four equations whose solutions are the position of the vehicle in cartesian coordinates, and $t_V$

\blue{
\begin{polynomial}
\begin{aligned}
|| \vect{x}_V - \vect{x}_{s_1} || - || \vect{x}_V - \vect{x}_{s_2} || + c(t_{s_2} - t_{s_1}) = 0 \\
|| \vect{x}_V - \vect{x}_{s_1} || - || \vect{x}_V - \vect{x}_{s_3} || + c(t_{s_3} - t_{s_1}) = 0 \\
|| \vect{x}_V - \vect{x}_{s_1} || - || \vect{x}_V - \vect{x}_{s_4} || + c(t_{s_4} - t_{s_1}) = 0 \\
t_V = t_s + \frac{|| \vect{x}_s(t_s) - \vect{x}_v||}{c}
\end{aligned}
\end{polynomial}
}
\blue{TODO I don't think we need 4 equations to come up with the position of the vehicle. Here our 4th one doesn't belong.}

\item[Exercise 11.] Suppose you have data of the form (11) from more than 4 satellites. Write down a least squares problem whose solution the position of the vehicle in cartesian coordinates, and $t_V$.

% TODO
\blue{
\begin{polynomial}
Ax=\vect{b} \\
x = A^{-1}\vect{b} \\
min(||Ax-\vect{b}||^2)
\end{polynomial}
}

\blue{
\begin{polynomial}
\begin{aligned}
F(\vect{x}_V) &= \left(\begin{matrix}
F_1(\vect{x}_V) \\
F_2(\vect{x}_V) \\
\vdots \\
F_m(\vect{x}_V)
\end{matrix}\right) \\
f &= F^\intercal F \\
&= F_1^2 + F_2^2 + \cdots + F_m^2 \\
&= || F ||^2 \\
F_m(x_V) &= ||\vect{x}_V - \vect{x}_{s_1}|| - ||\vect{x}_V - \vect{x}_{s_{m+1}} || + c (t_{s_{m+1}} - t_{s_1}) = 0
\end{aligned}
\end{polynomial}
}

\item[Exercise 12.] Find a formula for the \textit{ground track} of satellite 1, i.e. the position in geographic coordinates directly underneath the satellite on the surface of the earth, as a function of time. Do you notice anything particular? What is the significance of the orbital period being exactly one half sidereal day?

% TODO don't think I've thought of this one yet
\blue{
\begin{polynomial}
\begin{aligned}
\vect{x}_s(t) &= R \left[ \vect{u} cos(\frac{2 \pi t}{p} + \theta) + \vect{v} sin(\frac{2 \pi t}{p} + \theta) \right] \\
\end{aligned}
\end{polynomial}
If the orbital period of a satellite is half that of a sidereal day, it means it orbits twice for each single rotation of the earth. So this means that the satellite creates 
}

\item[Exercise 13.] Find a precise description of Newton's method as it is applied to the nonlinear system obtained by processing data from 4 satellites, as derived in an earlier exercise. Your answer should include an explicit specification of the derivatives involved.

% TODO
\blue{
\begin{polynomial}
\begin{aligned}
\vect{x}_s(t) &= (R + h) [ \vect{u} cos(\frac{2 \pi t}{p} + \theta) + \vect{v} sin(\frac{2 \pi t}{p} + \theta)] \\
\vect{x}_s^\prime(t) &= (R + h) \left[ \frac{2 \pi}{p} \left( -\vect{u} sin(\frac{2 \pi t}{p} + \theta) + \vect{v} cos(\frac{2 \pi t}{p} + \theta) \right) \right] \\
\end{aligned}
\end{polynomial}
}
\blue{
If $x = \left(\begin{matrix} x_1 \\ x_2 \\ \vdots \\ x_m \end{matrix}\right)$ \\
$F(x_V) = \left(\begin{matrix} F_1 \\ F_2 \\ F_3 \end{matrix}\right) = \left(\begin{matrix}
|| x_V - x_{s_1} || - || x_V - x_{s_2} || - c(t_{s_2} - t_{s_1}) \\
|| x_V - x_{s_1} || - || x_V - x_{s_3} || - c(t_{s_3} - t_{s_1}) \\
|| x_V - x_{s_1} || - || x_V - x_{s_4} || - c(t_{s_4} - t_{s_1})
\end{matrix}\right)$ \\
\begin{polynomial}
\begin{aligned}
\nabla F = \left(\begin{matrix} \nabla F_1 \\ \nabla F_2 \\ \nabla F_3 \end{matrix}\right) &=
\left(\begin{matrix}
\frac{\partial}{\partial x} F_1 & \frac{\partial}{\partial y} F_1 & \frac{\partial}{\partial z} F_1 \\
\frac{\partial}{\partial x} F_2 & \frac{\partial}{\partial y} F_2 & \frac{\partial}{\partial z} F_2 \\
\frac{\partial}{\partial x} F_3 & \frac{\partial}{\partial y} F_3 & \frac{\partial}{\partial z} F_3
\end{matrix}\right) \\
&= \left(\begin{matrix}
\frac{x_v - x_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{x_v - x_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} &
\frac{y_v - y_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{y_v - y_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} &
\frac{z_v - z_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{z_v - z_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} \\
\frac{x_v - x_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{x_v - x_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} &
\frac{y_v - y_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{y_v - y_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} &
\frac{z_v - z_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{z_v - z_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} \\
\frac{x_v - x_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{x_v - x_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} &
\frac{y_v - y_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{y_v - y_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||} &
\frac{z_v - z_{s_1}}{|| \vect{x}_v - \vect{x}_{s_1} ||} - \frac{z_v - z_{s_2}}{|| \vect{x}_v - \vect{x}_{s_2} ||}
\end{matrix}\right)
\end{aligned}
\end{polynomial}
}

\item[Exercise 14.] Similarly, find Newton's method for the nonlinear system obtained from the least squares approach. Again, your answer should include an explicit specification of the derivatives involved.

% TODO in notes
\blue{
TODO
}

\item[Exercise 15.] Think about the number of solutions obtained by analyzing four satellite signals with an unknown vehicle time $t_V$. This is an open ended question that will not be graded!

% TODO in notes
\blue{
TODO
}

\item[Exercise 16.] I gave an early draft of this assignment to my friend Meg Ikkal Anna Liszt. After muttering about the federal deficit she said that she has been talking to the Air Force (who operate GPS) for years. She does not understand why they are being so hard on themselves. She could save them billions of dollars because to determine position and altitude you only need three satellites, not four! Three satellites would give you three components of position, once you know position you can compute true run time to the satellite, and from that you can compute the current time. She thinks that the Air Force is not implementing this approach because they don't want to pay her fee of 10\% of the savings in launch costs of satellites alone. What do you think of this?

\blue{
TODO
}




\item[Exercise 17.] After venting her frustration about the federal deficit Meg went to task with \textit{me}. She said that ``you academic types'' like to be so cumbersome. She thinks we don't use ``common sense'' because the very phrase isn't rooted in Latin or Greek. Why, she says, do I have to have integers \textbf{NS} and \textbf{EW} to indicate which hemisphere I'm on? Why, she says, don't I just make the degrees positive or negative? Indeed, why not?

\blue{
TODO
}


\end{enumerate}

\end{document}  
